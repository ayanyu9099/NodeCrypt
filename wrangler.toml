name = "nodecrypt"
main = "worker/index.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# 配置静态资源
[assets]
directory = "./dist"
not_found_handling = "single-page-application"
run_worker_first = true
binding = "ASSETS"

[durable_objects]
bindings = [
  { name = "CHAT_ROOM", class_name = "ChatRoom" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatRoom"]

# KV 命名空间 - 用于存储 IP 禁言数据
# 需要先在 Cloudflare Dashboard 创建 KV namespace，或使用命令：
# wrangler kv:namespace create "MUTE_STORE"
# 然后将返回的 id 填入下方
[[kv_namespaces]]
binding = "MUTE_STORE"
id = "a6095b84cbd04256adc2b03bb8a3353d"  # 替换为实际的 KV namespace ID

# ============================================
# 房间配置说明 (Room Configuration)
# ============================================
# 在 Cloudflare Dashboard 中配置以下环境变量和机密：
# 
# 环境变量 (Variables):
#   ROOM_1_NAME = "客服1号"
#   ROOM_1_DESCRIPTION = "客服咨询专用"
#   ROOM_2_NAME = "客服2号"
#   ROOM_2_DESCRIPTION = "客服咨询专用"
#   ROOM_3_NAME = "VIP专属"
#   ROOM_3_DESCRIPTION = "VIP客户专属通道"
#
# 机密 (Secrets) - 使用 wrangler secret put 命令设置:
#   ROOM_1_PASSWORD = "your_room1_password"
#   ROOM_1_ADMIN_PASSWORD = "your_admin_password"
#   ROOM_2_PASSWORD = "your_room2_password"
#   ROOM_2_ADMIN_PASSWORD = "your_admin_password"
#   ROOM_3_PASSWORD = "your_vip_password"
#   ROOM_3_ADMIN_PASSWORD = "your_admin_password"
#
# 设置机密命令示例:
#   wrangler secret put ROOM_1_PASSWORD
#   wrangler secret put ROOM_1_ADMIN_PASSWORD
#
# 支持最多10个房间 (ROOM_1 到 ROOM_10)
# ============================================

# 开发环境变量 (用于本地开发，生产环境请在 Cloudflare Dashboard 配置)
[vars]
ROOM_1_NAME = "客服1号"
ROOM_1_PASSWORD = "test123"
ROOM_1_ADMIN_PASSWORD = "admin123"
ROOM_1_DESCRIPTION = "客服咨询专用"
ROOM_2_NAME = "客服2号"
ROOM_2_PASSWORD = "test456"
ROOM_2_ADMIN_PASSWORD = "admin456"
ROOM_2_DESCRIPTION = "客服咨询专用"
